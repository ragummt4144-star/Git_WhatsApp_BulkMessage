pipeline {
  agent any

  environment {
    CODACY_PROJECT_TOKEN = credentials('CODACY_PROJECT_TOKEN_ID')
  }

  stages {
    stage('Codacy analysis') {
      steps {
        bat '''
          codacy-analysis-cli analyze --directory . \
            --project-token $CODACY_PROJECT_TOKEN
        '''
      }
    }
  }
}
